OBJECT Codeunit 50012 DotNet_HashAlgorithm
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      DotNetHashAlgorithm@1000000000 : DotNet "'mscorlib'.System.Security.Cryptography.HashAlgorithm";
      EALGORITHM@1000000001 : TextConst 'ENU=Invalid Hash Algorithm';

    [External]
    PROCEDURE Create@1000000005(HashAlgorithm@1000000000 : Text);
    BEGIN
      IF NOT (UPPERCASE(HashAlgorithm) IN ['SHA1','MD5','SHA256','SHA384','SHA512']) THEN
        ERROR(EALGORITHM);
      DotNetHashAlgorithm := DotNetHashAlgorithm.Create(HashAlgorithm);
    END;

    [External]
    PROCEDURE ComputeHash@1000000001(VAR DotNet_ArrayData@1000000001 : Codeunit 3000;VAR DotNet_ArrayHash@1000 : Codeunit 3000);
    VAR
      DotNetArray@1000000000 : DotNet "'mscorlib'.System.Array";
    BEGIN
      DotNet_ArrayData.GetArray(DotNetArray);
      DotNet_ArrayHash.SetArray(DotNetHashAlgorithm.ComputeHash(DotNetArray));
    END;

    [External]
    PROCEDURE ComputeHashFromText@1000000000(VAR Text@1000000001 : Text;VAR DotNet_Array@1000 : Codeunit 3000);
    VAR
      DotNetEncoding@1000000002 : DotNet "'mscorlib'.System.Text.Encoding";
      DotNet_Encoding@1000000003 : Codeunit 3026;
    BEGIN
      IF Text = '' THEN
        EXIT;
      DotNet_Encoding.UTF8;
      DotNet_Encoding.GetEncoding(DotNetEncoding);
      DotNet_Array.SetArray(DotNetHashAlgorithm.ComputeHash(DotNetEncoding.GetBytes(Text)));
    END;

    [External]
    PROCEDURE ComputeHashFromInStream@5(VAR IStream@1000000001 : InStream;VAR DotNet_Array@1000 : Codeunit 3000);
    BEGIN
      DotNet_Array.SetArray(DotNetHashAlgorithm.ComputeHash(IStream));
    END;

    [External]
    PROCEDURE Dispose@1000000006();
    BEGIN
      DotNetHashAlgorithm.Dispose();
    END;

    PROCEDURE GetHashAlgorithm@2(VAR DotNetHashAlgorithm2@1000000001 : DotNet "'mscorlib'.System.Security.Cryptography.HashAlgorithm");
    BEGIN
      DotNetHashAlgorithm2 := DotNetHashAlgorithm;
    END;

    PROCEDURE SetHashAlgorithm@3(VAR DotNetHashAlgorithm2@1000000000 : DotNet "'mscorlib'.System.Security.Cryptography.HashAlgorithm");
    BEGIN
      DotNetHashAlgorithm := DotNetHashAlgorithm2;
    END;

    BEGIN
    END.
  }
}

