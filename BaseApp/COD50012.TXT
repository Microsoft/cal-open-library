OBJECT Codeunit 50012 DotNet_HashAlgorithm
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      DotNetHashAlgorithm@1000000000 : DotNet "'mscorlib'.System.Security.Cryptography.HashAlgorithm";
      EALGORITHM@1000000001 : TextConst 'ENU=Invalid Hash Algorithm';

    [External]
    [LineStart(201)]
    PROCEDURE Create@1000000005(HashAlgorithm@1000000000 : Text);
    BEGIN
      if not (UpperCase(HashAlgorithm) in ['SHA1','MD5','SHA256','SHA384','SHA512']) then
        Error(EALGORITHM);
      DotNetHashAlgorithm := DotNetHashAlgorithm.Create(HashAlgorithm);
    END;

    [External]
    [LineStart(206)]
    PROCEDURE ComputeHash@1000000001(VAR DotNet_ArrayData@1000000001 : Codeunit DotNet_Array;VAR DotNet_ArrayHash@1000 : Codeunit DotNet_Array);
    VAR
      DotNetArray@1000000000 : DotNet "'mscorlib'.System.Array";
    BEGIN
      DotNet_ArrayData.GetArray(DotNetArray);
      DotNet_ArrayHash.SetArray(DotNetHashAlgorithm.ComputeHash(DotNetArray));
    END;

    [External]
    [LineStart(210)]
    PROCEDURE ComputeHashFromText@1000000000(VAR Text@1000000001 : Text;VAR DotNet_Array@1000 : Codeunit DotNet_Array);
    VAR
      DotNetEncoding@1000000002 : DotNet "'mscorlib'.System.Text.Encoding";
      DotNet_Encoding@1000000003 : Codeunit DotNet_Encoding;
    BEGIN
      if Text = '' then
        exit;
      DotNet_Encoding.UTF8;
      DotNet_Encoding.GetEncoding(DotNetEncoding);
      DotNet_Array.SetArray(DotNetHashAlgorithm.ComputeHash(DotNetEncoding.GetBytes(Text)));
    END;

    [External]
    [LineStart(217)]
    PROCEDURE ComputeHashFromInStream@5(VAR IStream@1000000001 : InStream;VAR DotNet_Array@1000 : Codeunit DotNet_Array);
    BEGIN
      DotNet_Array.SetArray(DotNetHashAlgorithm.ComputeHash(IStream));
    END;

    [External]
    [LineStart(220)]
    PROCEDURE Dispose@1000000006();
    BEGIN
      DotNetHashAlgorithm.Dispose();
    END;

    [LineStart(223)]
    PROCEDURE GetHashAlgorithm@2(VAR DotNetHashAlgorithm2@1000000001 : DotNet "'mscorlib'.System.Security.Cryptography.HashAlgorithm");
    BEGIN
      DotNetHashAlgorithm2 := DotNetHashAlgorithm;
    END;

    [LineStart(226)]
    PROCEDURE SetHashAlgorithm@3(VAR DotNetHashAlgorithm2@1000000000 : DotNet "'mscorlib'.System.Security.Cryptography.HashAlgorithm");
    BEGIN
      DotNetHashAlgorithm := DotNetHashAlgorithm2;
    END;

    BEGIN
    END.
  }
}

