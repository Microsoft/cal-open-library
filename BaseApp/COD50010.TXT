OBJECT Codeunit 50010 DotNet_SymmetricAlgorithm
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      DotNetSymmetricAlgorithm@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Security.Cryptography.SymmetricAlgorithm";
      E_INVALID_ALGORITHM@1000000001 : TextConst 'ENU=Invalid Algorithm';

    [External]
    [LineStart(76)]
    PROCEDURE GetBlockSize@1000000000() : Integer;
    BEGIN
      exit(DotNetSymmetricAlgorithm.BlockSize);
    END;

    [External]
    [LineStart(79)]
    PROCEDURE SetBlockSize@1000000027(BlockSize@1000000000 : Integer);
    BEGIN
      DotNetSymmetricAlgorithm.BlockSize := BlockSize;
    END;

    [External]
    [LineStart(82)]
    PROCEDURE GetFeedbackSize@1000000007() : Integer;
    BEGIN
      exit(DotNetSymmetricAlgorithm.FeedbackSize);
    END;

    [External]
    [LineStart(85)]
    PROCEDURE SetFeedbackSize@1000000006(FeedbackSize@1000000000 : Integer);
    BEGIN
      DotNetSymmetricAlgorithm.FeedbackSize := FeedbackSize;
    END;

    [External]
    [LineStart(88)]
    PROCEDURE GetIV@1000000001(VAR DotNet_Array@1000000000 : Codeunit DotNet_Array);
    VAR
      DotNetArray@1000000001 : DotNet "'mscorlib'.System.Array";
    BEGIN
      DotNet_Array.GetArray(DotNetArray);
      DotNetArray := DotNetSymmetricAlgorithm.IV.Clone();
      DotNet_Array.SetArray(DotNetArray);
    END;

    [External]
    [LineStart(93)]
    PROCEDURE SetIV@1000000023(VAR DotNet_Array@1000000000 : Codeunit DotNet_Array);
    VAR
      DotNetArray@1000000001 : DotNet "'mscorlib'.System.Array";
    BEGIN
      DotNet_Array.GetArray(DotNetArray);
      DotNetSymmetricAlgorithm.IV := DotNetArray.Clone();
    END;

    [External]
    [LineStart(97)]
    PROCEDURE GetKey@1000000002(VAR DotNet_Array@1000000000 : Codeunit DotNet_Array);
    VAR
      DotNetArray@1000000001 : DotNet "'mscorlib'.System.Array";
    BEGIN
      DotNet_Array.GetArray(DotNetArray);
      DotNetArray := DotNetSymmetricAlgorithm.Key.Clone();
      DotNet_Array.SetArray(DotNetArray);
    END;

    [External]
    [LineStart(102)]
    PROCEDURE SetKey@1000000021(VAR DotNet_Array@1000000000 : Codeunit DotNet_Array);
    VAR
      DotNetArray@1000000001 : DotNet "'mscorlib'.System.Array";
    BEGIN
      DotNet_Array.GetArray(DotNetArray);
      DotNetSymmetricAlgorithm.Key := DotNetArray.Clone();
    END;

    [External]
    [LineStart(106)]
    PROCEDURE GetKeySize@1000000003() : Integer;
    BEGIN
      exit(DotNetSymmetricAlgorithm.KeySize);
    END;

    [External]
    [LineStart(109)]
    PROCEDURE SetKeySize@1000000018(KeySize@1000000000 : Integer);
    BEGIN
      DotNetSymmetricAlgorithm.KeySize := KeySize;
    END;

    [External]
    [LineStart(112)]
    PROCEDURE GetMode@1000000004(VAR DotNet_CipherMode@1000000000 : Codeunit DotNet_CipherMode);
    VAR
      DotNetCipherMode@1000000001 : DotNet "'mscorlib'.System.Security.Cryptography.CipherMode";
    BEGIN
      DotNetCipherMode := DotNetSymmetricAlgorithm.Mode;
      DotNet_CipherMode.SetCipherMode(DotNetCipherMode);
    END;

    [External]
    [LineStart(116)]
    PROCEDURE SetMode@1000000020(VAR DotNet_CipherMode@1000000000 : Codeunit DotNet_CipherMode);
    VAR
      DotNetCipherMode@1000000001 : DotNet "'mscorlib'.System.Security.Cryptography.CipherMode";
    BEGIN
      DotNet_CipherMode.GetCipherMode(DotNetCipherMode);
      DotNetSymmetricAlgorithm.Mode := DotNetCipherMode;
    END;

    [External]
    [LineStart(120)]
    PROCEDURE GetPadding@1000000005(VAR DotNet_PaddingMode@1000000001 : Codeunit DotNet_PaddingMode) : Integer;
    VAR
      DotNetPaddingMode@1000000000 : DotNet "'mscorlib'.System.Security.Cryptography.PaddingMode";
    BEGIN
      DotNetPaddingMode := DotNetSymmetricAlgorithm.Padding;
      DotNet_PaddingMode.SetPaddingMode(DotNetPaddingMode);
    END;

    [External]
    [LineStart(124)]
    PROCEDURE SetPadding@1000000019(VAR DotNet_PaddingMode@1000000002 : Codeunit DotNet_PaddingMode);
    VAR
      DotNetPaddingMode@1000000001 : DotNet "'mscorlib'.System.Security.Cryptography.PaddingMode";
    BEGIN
      DotNet_PaddingMode.GetPaddingMode(DotNetPaddingMode);
      DotNetSymmetricAlgorithm.Padding := DotNetPaddingMode;
    END;

    [External]
    [LineStart(128)]
    PROCEDURE Create@1000000028(Algorithm@1000000000 : Text);
    BEGIN
      if not (UpperCase(Algorithm) in ['AES','DES','RC2','RIJNDAEL','TRIPLEDES']) then
        Error(E_INVALID_ALGORITHM);
      Dispose();
      DotNetSymmetricAlgorithm := DotNetSymmetricAlgorithm.Create(Algorithm);
    END;

    [External]
    [LineStart(134)]
    PROCEDURE Dispose@1000000008();
    BEGIN
      if not IsNull(DotNetSymmetricAlgorithm) then
        DotNetSymmetricAlgorithm.Dispose();
    END;

    [External]
    [LineStart(138)]
    PROCEDURE CreateEncryptor@1000000009(VAR DotNet_ICryptoTransform@1000000000 : Codeunit DotNet_ICryptoTransform);
    VAR
      DotNetICryptoTransform@1000000001 : DotNet "'mscorlib'.System.Security.Cryptography.ICryptoTransform";
    BEGIN
      DotNetICryptoTransform := DotNetSymmetricAlgorithm.CreateEncryptor();
      DotNet_ICryptoTransform.SetICryptoTransform(DotNetICryptoTransform);
    END;

    [External]
    [LineStart(142)]
    PROCEDURE CreateDecryptor@1000000015(VAR DotNet_ICryptoTransform@1000000000 : Codeunit DotNet_ICryptoTransform);
    VAR
      DotNetICryptoTransform@1000000001 : DotNet "'mscorlib'.System.Security.Cryptography.ICryptoTransform";
    BEGIN
      DotNetICryptoTransform := DotNetSymmetricAlgorithm.CreateDecryptor();
      DotNet_ICryptoTransform.SetICryptoTransform(DotNetICryptoTransform);
    END;

    [LineStart(146)]
    PROCEDURE GetSymmetricAlgorithm@1000000013(VAR DotNetSymmetricAlgorithm2@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Security.Cryptography.SymmetricAlgorithm");
    BEGIN
      DotNetSymmetricAlgorithm2 := DotNetSymmetricAlgorithm;
    END;

    [LineStart(149)]
    PROCEDURE SetSymmetricAlgorithm@1000000014(VAR DotNetSymmetricAlgorithm2@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Security.Cryptography.SymmetricAlgorithm");
    BEGIN
      DotNetSymmetricAlgorithm := DotNetSymmetricAlgorithm2;
    END;

    BEGIN
    END.
  }
}

