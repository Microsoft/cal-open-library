OBJECT Codeunit 51010 Test_DotNet_SymmetricAlgorithm
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=;
  }
  PROPERTIES
  {
    Subtype=Test;
    TestPermissions=Disabled;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Assert@1001 : Codeunit 130000;
      IsInitialized@1000000002 : Boolean;
      Algorithm@1000000000 : 'Aes,DES,RC2,Rijndael,TripleDES';
      Mode@1000000003 : ',CBC,ECB,OFB,CFB,CTS';
      Padding@1000000001 : ',None,PKCS7,Zeros,ANSIX923,ISO10126';

    LOCAL PROCEDURE Initialize@1000000005();
    BEGIN
      IF IsInitialized THEN
        EXIT;
      IsInitialized := TRUE;
    END;

    [Test]
    PROCEDURE TestSymmetricAlgorithmCreate@1000000006();
    VAR
      DotNet_SymmetricAlgorithm@1000000000 : Codeunit 50010;
      DotNetSymmetricAlgorithm@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Security.Cryptography.SymmetricAlgorithm";
    BEGIN
      Initialize();
      SymmetricAlgorithmCreateAes();
      SymmetricAlgorithmCreateDES();
      SymmetricAlgorithmCreateRC2();
      SymmetricAlgorithmCreateRijndael();
      SymmetricAlgorithmCreateTripleDES();
    END;

    [Test]
    PROCEDURE TestSetGetMode@1000000008();
    VAR
      DotNet_SymmetricAlgorithm@1000000001 : Codeunit 50010;
      CipherMode@1000000000 : ',CBC,ECB,OFB,CFB,CTS';
    BEGIN
      Initialize();
      DotNet_SymmetricAlgorithm.Create(Algorithm::Aes);
      DotNet_SymmetricAlgorithm.SetMode(Mode::CBC);
      DotNet_SymmetricAlgorithm.GetMode(CipherMode);
      Assert.AreEqual(Mode::CBC, CipherMode, 'SymmetricAlgorithm Get/Set Mode failed');
    END;

    [Test]
    PROCEDURE TestSetGetPadding@1000000007();
    VAR
      DotNet_SymmetricAlgorithm@1000000000 : Codeunit 50010;
      PaddingMode@1000000001 : ',None,PKCS7,Zeros,ANSIX923,ISO10126';
    BEGIN
      Initialize();
      DotNet_SymmetricAlgorithm.Create(Algorithm::Aes);
      DotNet_SymmetricAlgorithm.SetMode(Padding::Zeros);
      DotNet_SymmetricAlgorithm.GetMode(PaddingMode);
      Assert.AreEqual(Padding::Zeros, PaddingMode, 'SymmetricAlgorithm Get/Set Padding failed');
    END;

    [Test]
    PROCEDURE TestSetGetBlockSize@1000000012();
    VAR
      DotNet_SymmetricAlgorithm@1000000000 : Codeunit 50010;
      BlockSize@1000000001 : Integer;
    BEGIN
      Initialize();
      DotNet_SymmetricAlgorithm.Create(Algorithm::Aes);
      DotNet_SymmetricAlgorithm.SetBlockSize(128);
      DotNet_SymmetricAlgorithm.GetBlockSize(BlockSize);
      Assert.AreEqual(128, BlockSize, 'SymmetricAlgorithm Get/Set Blocksize failed');
    END;

    [Test]
    PROCEDURE TestSetGetKeySize@1000000009();
    VAR
      DotNet_SymmetricAlgorithm@1000000000 : Codeunit 50010;
      KeySize@1000000001 : Integer;
    BEGIN
      Initialize();
      DotNet_SymmetricAlgorithm.Create(Algorithm::Aes);
      DotNet_SymmetricAlgorithm.SetKeySize(256);
      DotNet_SymmetricAlgorithm.GetKeySize(KeySize);
      Assert.AreEqual(256, KeySize, 'SymmetricAlgorithm Get/Set KeySize failed');
    END;

    [Test]
    PROCEDURE TestSetGetFeedbackSize@1000000013();
    VAR
      DotNet_SymmetricAlgorithm@1000000000 : Codeunit 50010;
      FeedbackSize@1000000001 : Integer;
    BEGIN
      Initialize();
      DotNet_SymmetricAlgorithm.Create(Algorithm::Aes);
      DotNet_SymmetricAlgorithm.SetBlockSize(128);
      DotNet_SymmetricAlgorithm.SetFeedbackSize(64);
      DotNet_SymmetricAlgorithm.GetFeedbackSize(FeedbackSize);
      Assert.AreEqual(64, FeedbackSize, 'SymmetricAlgorithm Get/Set FeedbackSize failed');
    END;

    [Test]
    PROCEDURE TestSetGetKey@1000000010();
    VAR
      DotNet_SymmetricAlgorithm@1000000000 : Codeunit 50010;
      DotNet_Array@1000000001 : Codeunit 3000;
      DotNet_ArrayKey@1000000002 : Codeunit 3000;
      Index@1000000003 : Integer;
    BEGIN
      Initialize();

      DotNet_Array.ByteArray(32);
      FOR Index := 0 TO DotNet_Array.Length-1 DO
        DotNet_Array.SetByteValue(Index, Index);

      DotNet_SymmetricAlgorithm.Create(Algorithm::Aes);
      DotNet_SymmetricAlgorithm.SetKeySize(256);
      DotNet_SymmetricAlgorithm.SetKey(DotNet_Array);
      DotNet_SymmetricAlgorithm.GetKey(DotNet_ArrayKey);
      FOR Index := 0 TO DotNet_Array.Length-1 DO
        Assert.AreEqual(
          DotNet_Array.GetValueAsInteger(Index),
          DotNet_ArrayKey.GetValueAsInteger(Index),
          'SymmetricAlgorithm Get/Set Key failed');
    END;

    [Test]
    PROCEDURE TestSetGetIV@1000000011();
    VAR
      DotNet_SymmetricAlgorithm@1000000000 : Codeunit 50010;
      DotNet_Array@1000000003 : Codeunit 3000;
      DotNet_ArrayIV@1000000002 : Codeunit 3000;
      Index@1000000001 : Integer;
    BEGIN
      Initialize();

      DotNet_Array.ByteArray(16);
      FOR Index := 0 TO DotNet_Array.Length-1 DO
        DotNet_Array.SetByteValue(Index, Index);

      DotNet_SymmetricAlgorithm.Create(Algorithm::Aes);
      DotNet_SymmetricAlgorithm.SetBlockSize(128);
      DotNet_SymmetricAlgorithm.SetIV(DotNet_Array);
      DotNet_SymmetricAlgorithm.GetIV(DotNet_ArrayIV);
      FOR Index := 0 TO DotNet_Array.Length-1 DO
        Assert.AreEqual(
          DotNet_Array.GetValueAsInteger(Index),
          DotNet_ArrayIV.GetValueAsInteger(Index),
          'SymmetricAlgorithm Get/Set IV failed');
    END;

    PROCEDURE SymmetricAlgorithmCreateAes@1000000000();
    VAR
      DotNet_SymmetricAlgorithm@1000000000 : Codeunit 50010;
      DotNetSymmetricAlgorithm@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Security.Cryptography.SymmetricAlgorithm";
    BEGIN
      DotNet_SymmetricAlgorithm.Create(Algorithm::Aes);
      DotNet_SymmetricAlgorithm.GetSymmetricAlgorithm(DotNetSymmetricAlgorithm);
      Assert.IsFalse(ISNULL(DotNetSymmetricAlgorithm), 'SymmetricAlgorithm Create AES failed');
    END;

    PROCEDURE SymmetricAlgorithmCreateDES@1000000003();
    VAR
      DotNet_SymmetricAlgorithm@1000000000 : Codeunit 50010;
      DotNetSymmetricAlgorithm@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Security.Cryptography.SymmetricAlgorithm";
    BEGIN
      DotNet_SymmetricAlgorithm.Create(Algorithm::DES);
      DotNet_SymmetricAlgorithm.GetSymmetricAlgorithm(DotNetSymmetricAlgorithm);
      Assert.IsFalse(ISNULL(DotNetSymmetricAlgorithm), 'SymmetricAlgorithm Create DES failed');
    END;

    PROCEDURE SymmetricAlgorithmCreateRC2@1000000001();
    VAR
      DotNet_SymmetricAlgorithm@1000000000 : Codeunit 50010;
      DotNetSymmetricAlgorithm@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Security.Cryptography.SymmetricAlgorithm";
    BEGIN
      DotNet_SymmetricAlgorithm.Create(Algorithm::RC2);
      DotNet_SymmetricAlgorithm.GetSymmetricAlgorithm(DotNetSymmetricAlgorithm);
      Assert.IsFalse(ISNULL(DotNetSymmetricAlgorithm), 'SymmetricAlgorithm Create RC2 failed');
    END;

    PROCEDURE SymmetricAlgorithmCreateRijndael@1000000002();
    VAR
      DotNet_SymmetricAlgorithm@1000000000 : Codeunit 50010;
      DotNetSymmetricAlgorithm@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Security.Cryptography.SymmetricAlgorithm";
    BEGIN
      DotNet_SymmetricAlgorithm.Create(Algorithm::Rijndael);
      DotNet_SymmetricAlgorithm.GetSymmetricAlgorithm(DotNetSymmetricAlgorithm);
      Assert.IsFalse(ISNULL(DotNetSymmetricAlgorithm), 'SymmetricAlgorithm Create Rijndael failed');
    END;

    PROCEDURE SymmetricAlgorithmCreateTripleDES@1000000004();
    VAR
      DotNet_SymmetricAlgorithm@1000000000 : Codeunit 50010;
      DotNetSymmetricAlgorithm@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Security.Cryptography.SymmetricAlgorithm";
    BEGIN
      DotNet_SymmetricAlgorithm.Create(Algorithm::TripleDES);
      DotNet_SymmetricAlgorithm.GetSymmetricAlgorithm(DotNetSymmetricAlgorithm);
      Assert.IsFalse(ISNULL(DotNetSymmetricAlgorithm), 'SymmetricAlgorithm Create TripleDES failed');
    END;

    BEGIN
    END.
  }
}

